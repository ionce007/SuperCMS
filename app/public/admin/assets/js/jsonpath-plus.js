class u{add(e,i,n){if(typeof arguments[0]!="string")for(let r in arguments[0])this.add(r,arguments[0][r],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(r){this[r]=this[r]||[],i&&this[r][n?"unshift":"push"](i)},this)}run(e,i){this[e]=this[e]||[],this[e].forEach(function(n){n.call(i&&i.context?i.context:i,i)})}}class O{constructor(e){this.jsep=e,this.registered={}}register(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.forEach(r=>{if(typeof r!="object"||!r.name||!r.init)throw new Error("Invalid JSEP plugin format");this.registered[r.name]||(r.init(this.jsep),this.registered[r.name]=r)})}}class t{static get version(){return"1.4.0"}static toString(){return"JavaScript Expression Parser (JSEP) v"+t.version}static addUnaryOp(e){return t.max_unop_len=Math.max(e.length,t.max_unop_len),t.unary_ops[e]=1,t}static addBinaryOp(e,i,n){return t.max_binop_len=Math.max(e.length,t.max_binop_len),t.binary_ops[e]=i,n?t.right_associative.add(e):t.right_associative.delete(e),t}static addIdentifierChar(e){return t.additional_identifier_chars.add(e),t}static addLiteral(e,i){return t.literals[e]=i,t}static removeUnaryOp(e){return delete t.unary_ops[e],e.length===t.max_unop_len&&(t.max_unop_len=t.getMaxKeyLen(t.unary_ops)),t}static removeAllUnaryOps(){return t.unary_ops={},t.max_unop_len=0,t}static removeIdentifierChar(e){return t.additional_identifier_chars.delete(e),t}static removeBinaryOp(e){return delete t.binary_ops[e],e.length===t.max_binop_len&&(t.max_binop_len=t.getMaxKeyLen(t.binary_ops)),t.right_associative.delete(e),t}static removeAllBinaryOps(){return t.binary_ops={},t.max_binop_len=0,t}static removeLiteral(e){return delete t.literals[e],t}static removeAllLiterals(){return t.literals={},t}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new t(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map(i=>i.length))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return t.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!t.binary_ops[String.fromCharCode(e)]||t.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return t.isIdentifierStart(e)||t.isDecimalDigit(e)}throwError(e){const i=new Error(e+" at character "+this.index);throw i.index=this.index,i.description=e,i}runHook(e,i){if(t.hooks[e]){const n={context:this,node:i};return t.hooks.run(e,n),n.node}return i}searchHook(e){if(t.hooks[e]){const i={context:this};return t.hooks[e].find(function(n){return n.call(i.context,i),i.node}),i.node}}gobbleSpaces(){let e=this.code;for(;e===t.SPACE_CODE||e===t.TAB_CODE||e===t.LF_CODE||e===t.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");const e=this.gobbleExpressions(),i=e.length===1?e[0]:{type:t.COMPOUND,body:e};return this.runHook("after-all",i)}gobbleExpressions(e){let i=[],n,r;for(;this.index<this.expr.length;)if(n=this.code,n===t.SEMCOL_CODE||n===t.COMMA_CODE)this.index++;else if(r=this.gobbleExpression())i.push(r);else if(this.index<this.expr.length){if(n===e)break;this.throwError('Unexpected "'+this.char+'"')}return i}gobbleExpression(){const e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,t.max_binop_len),i=e.length;for(;i>0;){if(t.binary_ops.hasOwnProperty(e)&&(!t.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!t.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=i,e;e=e.substr(0,--i)}return!1}gobbleBinaryExpression(){let e,i,n,r,s,o,l,a,b;if(o=this.gobbleToken(),!o||(i=this.gobbleBinaryOp(),!i))return o;for(s={value:i,prec:t.binaryPrecedence(i),right_a:t.right_associative.has(i)},l=this.gobbleToken(),l||this.throwError("Expected expression after "+i),r=[o,s,l];i=this.gobbleBinaryOp();){if(n=t.binaryPrecedence(i),n===0){this.index-=i.length;break}s={value:i,prec:n,right_a:t.right_associative.has(i)},b=i;const f=E=>s.right_a&&E.right_a?n>E.prec:n<=E.prec;for(;r.length>2&&f(r[r.length-2]);)l=r.pop(),i=r.pop().value,o=r.pop(),e={type:t.BINARY_EXP,operator:i,left:o,right:l},r.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+b),r.push(s,e)}for(a=r.length-1,e=r[a];a>1;)e={type:t.BINARY_EXP,operator:r[a-1].value,left:r[a-2],right:e},a-=2;return e}gobbleToken(){let e,i,n,r;if(this.gobbleSpaces(),r=this.searchHook("gobble-token"),r)return this.runHook("after-token",r);if(e=this.code,t.isDecimalDigit(e)||e===t.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===t.SQUOTE_CODE||e===t.DQUOTE_CODE)r=this.gobbleStringLiteral();else if(e===t.OBRACK_CODE)r=this.gobbleArray();else{for(i=this.expr.substr(this.index,t.max_unop_len),n=i.length;n>0;){if(t.unary_ops.hasOwnProperty(i)&&(!t.isIdentifierStart(this.code)||this.index+i.length<this.expr.length&&!t.isIdentifierPart(this.expr.charCodeAt(this.index+i.length)))){this.index+=n;const s=this.gobbleToken();return s||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:t.UNARY_EXP,operator:i,argument:s,prefix:!0})}i=i.substr(0,--n)}t.isIdentifierStart(e)?(r=this.gobbleIdentifier(),t.literals.hasOwnProperty(r.name)?r={type:t.LITERAL,value:t.literals[r.name],raw:r.name}:r.name===t.this_str&&(r={type:t.THIS_EXP})):e===t.OPAREN_CODE&&(r=this.gobbleGroup())}return r?(r=this.gobbleTokenProperty(r),this.runHook("after-token",r)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let i=this.code;for(;i===t.PERIOD_CODE||i===t.OBRACK_CODE||i===t.OPAREN_CODE||i===t.QUMARK_CODE;){let n;if(i===t.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==t.PERIOD_CODE)break;n=!0,this.index+=2,this.gobbleSpaces(),i=this.code}this.index++,i===t.OBRACK_CODE?(e={type:t.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()},e.property||this.throwError('Unexpected "'+this.char+'"'),this.gobbleSpaces(),i=this.code,i!==t.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):i===t.OPAREN_CODE?e={type:t.CALL_EXP,arguments:this.gobbleArguments(t.CPAREN_CODE),callee:e}:(i===t.PERIOD_CODE||n)&&(n&&this.index--,this.gobbleSpaces(),e={type:t.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),n&&(e.optional=!0),this.gobbleSpaces(),i=this.code}return e}gobbleNumericLiteral(){let e="",i,n;for(;t.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(this.code===t.PERIOD_CODE)for(e+=this.expr.charAt(this.index++);t.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(i=this.char,i==="e"||i==="E"){for(e+=this.expr.charAt(this.index++),i=this.char,(i==="+"||i==="-")&&(e+=this.expr.charAt(this.index++));t.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);t.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+e+this.char+")")}return n=this.code,t.isIdentifierStart(n)?this.throwError("Variable names cannot start with a number ("+e+this.char+")"):(n===t.PERIOD_CODE||e.length===1&&e.charCodeAt(0)===t.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:t.LITERAL,value:parseFloat(e),raw:e}}gobbleStringLiteral(){let e="";const i=this.index,n=this.expr.charAt(this.index++);let r=!1;for(;this.index<this.expr.length;){let s=this.expr.charAt(this.index++);if(s===n){r=!0;break}else if(s==="\\")switch(s=this.expr.charAt(this.index++),s){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=s}else e+=s}return r||this.throwError('Unclosed quote after "'+e+'"'),{type:t.LITERAL,value:e,raw:this.expr.substring(i,this.index)}}gobbleIdentifier(){let e=this.code,i=this.index;for(t.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,t.isIdentifierPart(e));)this.index++;return{type:t.IDENTIFIER,name:this.expr.slice(i,this.index)}}gobbleArguments(e){const i=[];let n=!1,r=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let s=this.code;if(s===e){n=!0,this.index++,e===t.CPAREN_CODE&&r&&r>=i.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}else if(s===t.COMMA_CODE){if(this.index++,r++,r!==i.length){if(e===t.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===t.CBRACK_CODE)for(let o=i.length;o<r;o++)i.push(null)}}else if(i.length!==r&&r!==0)this.throwError("Expected comma");else{const o=this.gobbleExpression();(!o||o.type===t.COMPOUND)&&this.throwError("Expected comma"),i.push(o)}}return n||this.throwError("Expected "+String.fromCharCode(e)),i}gobbleGroup(){this.index++;let e=this.gobbleExpressions(t.CPAREN_CODE);if(this.code===t.CPAREN_CODE)return this.index++,e.length===1?e[0]:e.length?{type:t.SEQUENCE_EXP,expressions:e}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:t.ARRAY_EXP,elements:this.gobbleArguments(t.CBRACK_CODE)}}}const C=new u;Object.assign(t,{hooks:C,plugins:new O(t),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"??":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10,"**":11},right_associative:new Set(["**"]),additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});t.max_unop_len=t.getMaxKeyLen(t.unary_ops);t.max_binop_len=t.getMaxKeyLen(t.binary_ops);const d=h=>new t(h).parse(),p=Object.getOwnPropertyNames(class{});Object.getOwnPropertyNames(t).filter(h=>!p.includes(h)&&d[h]===void 0).forEach(h=>{d[h]=t[h]});d.Jsep=t;const y="ConditionalExpression";var D={name:"ternary",init(h){h.hooks.add("after-expression",function(i){if(i.node&&this.code===h.QUMARK_CODE){this.index++;const n=i.node,r=this.gobbleExpression();if(r||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===h.COLON_CODE){this.index++;const s=this.gobbleExpression();if(s||this.throwError("Expected expression"),i.node={type:y,test:n,consequent:r,alternate:s},n.operator&&h.binary_ops[n.operator]<=.9){let o=n;for(;o.right.operator&&h.binary_ops[o.right.operator]<=.9;)o=o.right;i.node.test=o.right,o.right=i.node,i.node=n}}else this.throwError("Expected :")}})}};d.plugins.register(D);const g=47,A=92;var m={name:"regex",init(h){h.hooks.add("gobble-token",function(i){if(this.code===g){const n=++this.index;let r=!1;for(;this.index<this.expr.length;){if(this.code===g&&!r){const s=this.expr.slice(n,this.index);let o="";for(;++this.index<this.expr.length;){const a=this.code;if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57)o+=this.char;else break}let l;try{l=new RegExp(s,o)}catch(a){this.throwError(a.message)}return i.node={type:h.LITERAL,value:l,raw:this.expr.slice(n-1,this.index)},i.node=this.gobbleTokenProperty(i.node),i.node}this.code===h.OBRACK_CODE?r=!0:r&&this.code===h.CBRACK_CODE&&(r=!1),this.index+=this.code===A?2:1}this.throwError("Unclosed Regex")}})}};const x=43,P=45,c={name:"assignment",assignmentOperators:new Set(["=","*=","**=","/=","%=","+=","-=","<<=",">>=",">>>=","&=","^=","|=","||=","&&=","??="]),updateOperators:[x,P],assignmentPrecedence:.9,init(h){const e=[h.IDENTIFIER,h.MEMBER_EXP];c.assignmentOperators.forEach(n=>h.addBinaryOp(n,c.assignmentPrecedence,!0)),h.hooks.add("gobble-token",function(r){const s=this.code;c.updateOperators.some(o=>o===s&&o===this.expr.charCodeAt(this.index+1))&&(this.index+=2,r.node={type:"UpdateExpression",operator:s===x?"++":"--",argument:this.gobbleTokenProperty(this.gobbleIdentifier()),prefix:!0},(!r.node.argument||!e.includes(r.node.argument.type))&&this.throwError("Unexpected ".concat(r.node.operator)))}),h.hooks.add("after-token",function(r){if(r.node){const s=this.code;c.updateOperators.some(o=>o===s&&o===this.expr.charCodeAt(this.index+1))&&(e.includes(r.node.type)||this.throwError("Unexpected ".concat(r.node.operator)),this.index+=2,r.node={type:"UpdateExpression",operator:s===x?"++":"--",argument:r.node,prefix:!1})}}),h.hooks.add("after-expression",function(r){r.node&&i(r.node)});function i(n){c.assignmentOperators.has(n.operator)?(n.type="AssignmentExpression",i(n.left),i(n.right)):n.operator||Object.values(n).forEach(r=>{r&&typeof r=="object"&&i(r)})}}};d.plugins.register(m,c);d.addUnaryOp("typeof");d.addLiteral("null",null);d.addLiteral("undefined",void 0);
