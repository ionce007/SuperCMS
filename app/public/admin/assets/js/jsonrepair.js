class w extends Error{constructor(e,r){super("".concat(e," at position ").concat(r)),this.position=r}}const q=32,fe=10,H=9,P=13,ae=160,de=8192,pe=8202,he=8239,ge=8287,we=12288;function me(n){return/^[0-9A-Fa-f]$/.test(n)}function d(n){return n>="0"&&n<="9"}function Ce(n){return n>=" "}function O(n){return",:[]/{}()\n+".includes(n)}function L(n){return n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_"||n==="$"}function F(n){return n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_"||n==="$"||n>="0"&&n<="9"}const R=/^(http|https|ftp|mailto|file|data|irc):\/\/$/,Z=/^[A-Za-z0-9-._~:/?#@!$&'()*+;=]$/;function _(n){return",[]/{}\n+".includes(n)}function z(n){return y(n)||be.test(n)}const be=/^[[{\w-]$/;function Se(n){return n==="\n"||n==="\r"||n==="	"||n==="\b"||n==="\f"}function p(n,e){const r=n.charCodeAt(e);return r===q||r===fe||r===H||r===P}function Ne(n,e){const r=n.charCodeAt(e);return r===q||r===H||r===P}function ke(n,e){const r=n.charCodeAt(e);return r===ae||r>=de&&r<=pe||r===he||r===ge||r===we}function y(n){return G(n)||Q(n)}function G(n){return n==='"'||n==="“"||n==="”"}function M(n){return n==='"'}function Q(n){return n==="'"||n==="‘"||n==="’"||n==="`"||n==="´"}function T(n){return n==="'"}function S(n,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const N=n.lastIndexOf(e);return N!==-1?n.substring(0,N)+(r?"":n.substring(N+1)):n}function l(n,e){let r=n.length;if(!p(n,r-1))return n+e;for(;p(n,r-1);)r--;return n.substring(0,r)+e+n.substring(r)}function Ae(n,e,r){return n.substring(0,e)+n.substring(e+r)}function Ee(n){return/[,\n][ \t\r]*$/.test(n)}const Oe={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},ye={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"};function We(n){let e=0,r="";V(),m()||ce(),V();const v=C(",");for(v&&c(),z(n[e])&&Ee(r)?(v||(r=l(r,",")),ne()):v&&(r=S(r,","));n[e]==="}"||n[e]==="]";)e++,c();if(e>=n.length)return r;oe();function m(){c();const i=x()||ee()||h()||re()||ie()||B(!1)||se();return c(),i}function c(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const s=e;let u=U(i);do u=X(),u&&(u=U(i));while(u);return e>s}function U(i){const s=i?p:Ne;let u="";for(;;)if(s(n,e))u+=n[e],e++;else if(ke(n,e))u+=" ",e++;else break;return u.length>0?(r+=u,!0):!1}function X(){if(n[e]==="/"&&n[e+1]==="*"){for(;e<n.length&&!ve(n,e);)e++;return e+=2,!0}if(n[e]==="/"&&n[e+1]==="/"){for(;e<n.length&&n[e]!=="\n";)e++;return!0}return!1}function V(){if(n.slice(e,e+3)==="```"){if(e+=3,L(n[e]))for(;e<n.length&&F(n[e]);)e++;return c(),!0}return!1}function C(i){return n[e]===i?(r+=n[e],e++,!0):!1}function k(i){return n[e]===i?(e++,!0):!1}function Y(){return k("\\")}function j(){return c(),n[e]==="."&&n[e+1]==="."&&n[e+2]==="."?(e+=3,c(),k(","),!0):!1}function x(){if(n[e]==="{"){r+="{",e++,c(),k(",")&&c();let i=!0;for(;e<n.length&&n[e]!=="}";){let s;if(i?(s=!0,i=!1):(s=C(","),s||(r=l(r,",")),c()),j(),!(h()||B(!0))){n[e]==="}"||n[e]==="{"||n[e]==="]"||n[e]==="["||n[e]===void 0?r=S(r,","):te();break}c();const E=C(":"),a=e>=n.length;E||(z(n[e])||a?r=l(r,":"):J()),m()||(E||a?r+="null":J())}return n[e]==="}"?(r+="}",e++):r=l(r,"}"),!0}return!1}function ee(){if(n[e]==="["){r+="[",e++,c(),k(",")&&c();let i=!0;for(;e<n.length&&n[e]!=="]";)if(i?i=!1:C(",")||(r=l(r,",")),j(),!m()){r=S(r,",");break}return n[e]==="]"?(r+="]",e++):r=l(r,"]"),!0}return!1}function ne(){let i=!0,s=!0;for(;s;)i?i=!1:C(",")||(r=l(r,",")),s=m();s||(r=S(r,",")),r="[\n".concat(r,"\n]")}function h(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,u=n[e]==="\\";if(u&&(e++,u=!0),y(n[e])){const E=M(n[e])?M:T(n[e])?T:Q(n[e])?Q:G,a=e,b=r.length;let o='"';for(e++;;){if(e>=n.length){const t=D(e-1);return!i&&O(n.charAt(t))?(e=a,r=r.substring(0,b),h(!0)):(o=l(o,'"'),r+=o,!0)}else{if(e===s)return o=l(o,'"'),r+=o,!0;if(E(n[e])){const t=e,I=o.length;if(o+='"',e++,r+=o,c(!1),i||e>=n.length||O(n[e])||y(n[e])||d(n[e]))return $(),!0;const f=D(t-1),K=n.charAt(f);if(K===",")return e=a,r=r.substring(0,b),h(!1,f);if(O(K))return e=a,r=r.substring(0,b),h(!0);r=r.substring(0,b),e=t+1,o="".concat(o.substring(0,I),"\\").concat(o.substring(I))}else if(i&&_(n[e])){if(n[e-1]===":"&&R.test(n.substring(a+1,e+2)))for(;e<n.length&&Z.test(n[e]);)o+=n[e],e++;return o=l(o,'"'),r+=o,$(),!0}else if(n[e]==="\\"){const t=n.charAt(e+1);if(ye[t]!==void 0)o+=n.slice(e,e+2),e+=2;else if(t==="u"){let f=2;for(;f<6&&me(n[e+f]);)f++;f===6?(o+=n.slice(e,e+6),e+=6):e+f>=n.length?e=n.length:le()}else o+=t,e+=2}else{const t=n.charAt(e);t==='"'&&n[e-1]!=="\\"?(o+="\\".concat(t),e++):Se(t)?(o+=Oe[t],e++):(Ce(t)||ue(t),o+=t,e++)}}u&&Y()}}return!1}function $(){let i=!1;for(c();n[e]==="+";){i=!0,e++,c(),r=S(r,'"',!0);const s=r.length;h()?r=Ae(r,s,1):r=l(r,'"')}return i}function re(){const i=e;if(n[e]==="-"){if(e++,A())return W(i),!0;if(!d(n[e]))return e=i,!1}for(;d(n[e]);)e++;if(n[e]==="."){if(e++,A())return W(i),!0;if(!d(n[e]))return e=i,!1;for(;d(n[e]);)e++}if(n[e]==="e"||n[e]==="E"){if(e++,(n[e]==="-"||n[e]==="+")&&e++,A())return W(i),!0;if(!d(n[e]))return e=i,!1;for(;d(n[e]);)e++}if(!A())return e=i,!1;if(e>i){const s=n.slice(i,e),u=/^0\d/.test(s);return r+=u?'"'.concat(s,'"'):s,!0}return!1}function ie(){return g("true","true")||g("false","false")||g("null","null")||g("True","true")||g("False","false")||g("None","null")}function g(i,s){return n.slice(e,e+i.length)===i?(r+=s,e+=i.length,!0):!1}function B(i){const s=e;if(L(n[e])){for(;e<n.length&&F(n[e]);)e++;let u=e;for(;p(n,u);)u++;if(n[u]==="(")return e=u+1,m(),n[e]===")"&&(e++,n[e]===";"&&e++),!0}for(;e<n.length&&!_(n[e])&&!y(n[e])&&(!i||n[e]!==":");)e++;if(n[e-1]===":"&&R.test(n.substring(s,e+2)))for(;e<n.length&&Z.test(n[e]);)e++;if(e>s){for(;p(n,e-1)&&e>0;)e--;const u=n.slice(s,e);return r+=u==="undefined"?"null":JSON.stringify(u),n[e]==='"'&&e++,!0}}function se(){if(n[e]==="/"){const i=e;for(e++;e<n.length&&(n[e]!=="/"||n[e-1]==="\\");)e++;return e++,r+='"'.concat(n.substring(i,e),'"'),!0}}function D(i){let s=i;for(;s>0&&p(n,s);)s--;return s}function A(){return e>=n.length||O(n[e])||p(n,e)}function W(i){r+="".concat(n.slice(i,e),"0")}function ue(i){throw new w("Invalid character ".concat(JSON.stringify(i)),e)}function oe(){throw new w("Unexpected character ".concat(JSON.stringify(n[e])),e)}function ce(){throw new w("Unexpected end of json string",n.length)}function te(){throw new w("Object key expected",e)}function J(){throw new w("Colon expected",e)}function le(){const i=n.slice(e,e+6);throw new w('Invalid unicode character "'.concat(i,'"'),e)}}function ve(n,e){return n[e]==="*"&&n[e+1]==="/"}export{We as j};
