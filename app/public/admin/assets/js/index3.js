var q=Object.defineProperty;var D=(l,t,c)=>t in l?q(l,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[t]=c;var y=(l,t,c)=>D(l,typeof t!="symbol"?t+"":t,c);import{q as N,r as z,s as O,f as Y,t as C}from"./element-plus.js";import{c as L,o as M,a as r,W as P,r as S,n as H,O as a,L as f,ah as K,a3 as _,u as G,I as W}from"./@vue.js";import{u as J,a as Q}from"./vue-router.js";import{M as X}from"./vue3-puzzle-vcode.js";import{_ as $,A as v,h as n,u as Z,s as E}from"./index.js";import{g as tt,d as et,c as ot}from"./login_log.js";import"./js-cookie.js";import"./dayjs.js";import"./@element-plus.js";import"./lodash-es.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vanilla-jsoneditor.js";import"./json-source-map.js";import"./@jsonquerylang.js";import"./@fortawesome.js";import"./natural-compare-lite.js";import"./fast-deep-equal.js";import"./fast-uri.js";import"./jmespath.js";import"./jsonpath-plus.js";import"./@codemirror.js";import"./@lezer.js";import"./crelt.js";import"./@marijn.js";import"./style-mod.js";import"./w3c-keyname.js";import"./@replit.js";import"./immutable-json-patch.js";import"./jsonrepair.js";import"./axios.js";import"./nprogress.js";/* empty css     */const rt={},st={xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"64px",height:"64px",viewBox:"0 0 64 64","xml:space":"preserve"};function at(l,t){return M(),L("svg",st,t[0]||(t[0]=[r("g",null,[r("path",{"fill-rule":"evenodd",fill:"#1A85F8",d:"M45.354,29.9C45.354,17.983,32.5,9,32.5,9C18.529,20.55,20.206,30.45,20.206,30.45\r\n			C12.289,24.675,4,27.15,4,27.15s2.515,4.125,3.912,7.149c1.397,3.025,2.515,6.05,6.147,10.45c3.633,4.4,8.941,6.6,8.941,6.6\r\n			s-2.235-1.466-2.235-5.5c0-5.041,5.588-6.05,5.588-6.05c-0.932-0.825-1.677-2.108-1.677-4.399c0-2.292,2.049-4.309,4.471-6.051\r\n			c2.422-1.741,3.912-3.85,3.912-3.85c0,0.458,2.049,3.208,3.354,4.4c1.304,1.191,4.471,2.566,4.471,5.5\r\n			c0,2.933-1.677,4.399-1.677,4.399c3.26,0.459,5.588,3.392,5.588,6.05c0,2.659-1.118,4.4-1.118,4.4\r\n			c8.569-3.941,10.898-10.908,12.854-15.4C58.485,30.358,61,26.6,61,26.6C50.755,26.6,45.354,29.9,45.354,29.9z"})],-1),r("g",null,[r("path",{"fill-rule":"evenodd",fill:"#CBAD29",d:"M35.854,47.5c2.234,0,3.818-2.842,2.793-4.4c-1.023-1.558-2.142-3.3-5.588-3.3\r\n			c-3.446,0-5.588,2.384-5.588,5.5c0,3.117,2.98,7.608,8.941,7.7c0,0-5.402-2.384-3.912-7.7C32.5,45.3,33.617,47.5,35.854,47.5z"})],-1)]))}const lt=$(rt,[["render",at]]),s=class s{version(){return"v.1.0"}static get(t={}){return n({url:"".concat(s.API,"/api/get"),method:"GET",params:t,withCredentials:!1})}static post(t={}){return n({url:"".concat(s.API,"/api/post"),method:"POST",data:t})}static put(t={}){return n({url:"".concat(s.API,"/api/put"),method:"PUT",data:t})}static patch(t={}){return n({url:"".concat(s.API,"/api/patch"),method:"PATCH",data:t})}static delete(){return n({url:"".concat(s.API,"/api/delete?id=1"),method:"Delete"})}};y(s,"API",v.BASE_API),y(s,"upload",t=>n({url:"".concat(s.API,"/api/delete?id=1"),method:"post",headers:{"Content-type":"multipart/form-data"},data:t}));let x=s;class k extends x{constructor(t){super(t)}static toLogin(t){return n({url:"".concat(v.BASE_API,"/api/sysUser/login"),method:"post",data:t})}static userInfo(){return n({url:"".concat(v.BASE_API,"/api/sysUser/detail"),method:"get"})}static menuList(){return new Promise((t,c)=>{setTimeout(()=>{let p=asyncRoutes;t({code:200,data:p})},300)})}}const it={class:"flex login-background"},nt={class:"login-wrap flex justify-center items-center flex-col flex-1"},ct={class:"login flex flex-col justify-center items-center /*w-full*/ pl-400"},pt={__name:"index",setup(l){const t=J(),c=Q(),p=Z(),u=P({username:"",password:""}),w=S(!1),I=P({ip:"",country:"",prov:"",city:"",district:"",isp:"",lat:"",lng:""}),V=["/public/cover/sea/01.png","/public/cover/sea/02.png","/public/cover/sea/03.png","/public/cover/sea/04.png","/public/cover/sea/05.png","/public/cover/sea/06.png","/public/cover/sea/07.png"],b=S(null),T=()=>{B()},U=e=>{console.log(e)},A=async()=>{b.value.validate(e=>{if(e)w.value=!0;else return!1})},B=async()=>{const{username:e,password:o}=u,i=await k.toLogin({username:e,password:o});i.code===200?(p.setToken(i.data.token),await R(),await et(),await ot(I),C({title:"提示",message:"登录成功",duration:900,type:"success"}),t.push(c.query.redirect||"/")):i.code===201&&(C({title:"提示",message:"登录失败",type:"error"}),w.value=!1)},F=async()=>{try{let e=await tt();if(e.code==="Success"){const{country:o,prov:i,district:m,city:g,isp:h,lat:d,lng:j}=e.data;Object.assign(I,{ip:e.ip||"localhost",country:o,prov:i,city:g,district:m,isp:h,lat:d,lng:j}),E("ip",e.ip),E("city",g)}}catch(e){console.log(e)}},R=async()=>{try{const e=await k.userInfo();if(e.code===200){let o=e.data;p.setUserInfo(o),p.setRole(o.value),p.getMenuList()}}catch(e){console.log(e)}};return H(()=>{document.getElementById("curYear").innerHTML=new Date().getFullYear(),F()}),(e,o)=>{const i=O,m=z,g=Y,h=N;return M(),L(W,null,[r("div",it,[r("div",nt,[r("div",ct,[a(lt,{class:"icon"}),o[3]||(o[3]=r("h1",null,"SuperCMS",-1)),a(h,{class:"mt-20 login-form",model:u,ref_key:"formRef",ref:b,"label-width":"70px",onKeyup:K(A,["enter"])},{default:f(()=>[a(m,{label:"用户名",prop:"username","label-position":"left",rules:[{required:!0,message:"请输入用户名",trigger:"blur"}]},{default:f(()=>[a(i,{modelValue:u.username,"onUpdate:modelValue":o[0]||(o[0]=d=>u.username=d),placeholder:"请输入用户名","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),a(m,{label:"密码",prop:"password","label-position":"left",rules:[{required:!0,message:"请输入密码",trigger:"blur"}]},{default:f(()=>[a(i,{type:"password",modelValue:u.password,"onUpdate:modelValue":o[1]||(o[1]=d=>u.password=d),placeholder:"请输入密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),a(m,null,{default:f(()=>[a(g,{class:"w-full",type:"primary",size:"large",onClick:A},{default:f(()=>o[2]||(o[2]=[_(" 登录 ")])),_:1})]),_:1})]),_:1},8,["model"])]),o[4]||(o[4]=r("footer",{class:"w-full overflow-h"},[r("p",{class:"f-13 text-c mt-10"},[_(" Copyright © 2018 ~ "),r("span",{id:"curYear"}),r("a",{href:"https://cms.foryet.com",class:"mr-5 ml-10",target:"_blank",title:"SuperCMS"},"SuperCMS"),_(" ● 位于广州 服务全国 ")])],-1))])]),a(G(X),{imgs:V,show:w.value,onSuccess:T,onFail:U},null,8,["show"])],64)}}},Wt=$(pt,[["__scopeId","data-v-bc853399"]]);export{Wt as default};
