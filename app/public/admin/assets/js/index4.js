import{r as Y,x as Z,s as ee,f as te,q as oe,N as ae,I as le,O as re,P as ne,Q as se,w as ie,E as w,R as ce}from"./element-plus.js";import{u as de,a as ue}from"./vue-router.js";import{G as me,i as pe,v as fe,H as _e,E as ve}from"./@element-plus.js";import{s as ye,b as R}from"./article.js";import{f as we}from"./category.js";import{_ as ge,a as he,t as ke}from"./index.js";import{r,W as be,w as Ce,n as xe,ab as Ee,c as T,o as g,a as h,O as o,L as l,u as m,a3 as p,T as $e,K as Se,H as Ve,Q as B}from"./@vue.js";import"./dayjs.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vanilla-jsoneditor.js";import"./json-source-map.js";import"./@jsonquerylang.js";import"./@fortawesome.js";import"./natural-compare-lite.js";import"./fast-deep-equal.js";import"./fast-uri.js";import"./jmespath.js";import"./jsonpath-plus.js";import"./@codemirror.js";import"./@lezer.js";import"./crelt.js";import"./@marijn.js";import"./style-mod.js";import"./w3c-keyname.js";import"./@replit.js";import"./immutable-json-patch.js";import"./jsonrepair.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const Re={class:"bg-fff radius-6 pd-20 mb-10"},Te={class:"radius-6 bg-fff pd-20"},Be={class:"flex justify-between align-c"},Pe=["href"],qe={__name:"index",setup(Ne){const _=de(),P=ue(),f=r(location.origin),k=r(null),q=r(null),v=r(!0),b=r([]),C=r([]),x=r(0),s=r(1),d=r(0),E=r([]),n=be({keywords:"",categorySelected:[]}),$=e=>{e&&k.value.resetFields(),_.replace({name:"article-index",query:{cur:1,cid:0,keywords:""}}),s.value=1,n.keywords="",d.value=0,u()},S=()=>{_.replace({name:"article-index",query:{cur:s.value,cid:d.value,keywords:n.keywords}}),u()},u=async()=>{try{v.value=!0;const e=await ye(s.value,n.keywords,d.value);e.code===200&&(b.value=[...e.data.list],x.value=e.data.count,s.value=e.data.current,v.value=!1)}catch(e){console.error(e)}},N=e=>{s.value=e,S()},D=e=>{C.value=e},F=async()=>{try{const e=await we();if(e.code===200){const t=he(ke(e.data));E.value=[...t]}}catch(e){console.error(e)}},I=e=>{d.value=e[e.length-1]},j=e=>{_.push({name:"article-edit",params:{id:e.id}})},A=()=>{},L=async()=>{const e=C.value.map(t=>t.id).join(",");try{(await R(e)).code===200&&(w({message:"删除成功 ^_^",type:"success"}),u())}catch(t){console.error(t)}},M=e=>{const t=e.type=="0"?"".concat(f.value,"/article-").concat(e.id,".html"):"".concat(f.value).concat(e.path,"/page-").concat(e.id,".html");window.open(t)},U=e=>{ce.confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{(await R(e.id)).code===200&&(w({message:"文章删除成功 ^_^",type:"success"}),u())}catch(t){console.error(t)}}).catch(()=>{w({type:"info",message:"已取消删除"})})};return Ce(()=>P.query,e=>{s.value=e.cur,d.value=e.cid,n.keywords=e.keywords||"",u()},{immediate:!0}),xe(()=>{F()}),(e,t)=>{const H=Z,y=Y,O=ee,i=te,z=oe,G=ae,K=Ee("router-link"),c=re,W=ne,J=se,Q=ie,X=le;return g(),T("div",null,[h("div",Re,[o(z,{inline:!0,model:n,"label-width":"68px",ref_key:"formRef",ref:k},{default:l(()=>[o(y,{label:"栏目筛选",prop:"categorySelected"},{default:l(()=>[o(H,{"show-all-levels":!1,modelValue:n.categorySelected,"onUpdate:modelValue":t[0]||(t[0]=a=>n.categorySelected=a),options:E.value,onChange:I},null,8,["modelValue","options"])]),_:1}),o(y,{label:"标题",prop:"keywords"},{default:l(()=>[o(O,{placeholder:"请输入文章标题","suffix-icon":m(me),modelValue:n.keywords,"onUpdate:modelValue":t[1]||(t[1]=a=>n.keywords=a),clearable:"",onClear:$},null,8,["suffix-icon","modelValue"])]),_:1}),o(y,null,{default:l(()=>[o(i,{type:"primary",onClick:S,round:""},{default:l(()=>t[4]||(t[4]=[p("搜索")])),_:1}),o(i,{onClick:t[2]||(t[2]=a=>$("formRef")),round:""},{default:l(()=>t[5]||(t[5]=[p("清空")])),_:1})]),_:1})]),_:1},8,["model"])]),h("div",Te,[h("div",Be,[o(G,{"confirm-button-text":"确定","cancel-button-text":"取消",icon:m(pe),"icon-color":"#626AEF",title:"此操作将永久删除, 是否继续?",onConfirm:L,onCancel:A},{reference:l(()=>[o(i,null,{default:l(()=>t[6]||(t[6]=[p("删除")])),_:1})]),_:1},8,["icon"]),o(K,{class:"mt-10",to:"/article/add"},{default:l(()=>[o(i,{type:"primary",round:""},{default:l(()=>t[7]||(t[7]=[p("新增")])),_:1})]),_:1})]),$e((g(),Se(W,{ref_key:"multipleTableRef",ref:q,data:b.value,"tooltip-effect":"dark","row-key":"id",onSelectionChange:D},{default:l(()=>[o(c,{type:"selection"}),o(c,{prop:"id",label:"编号",width:"120",fixed:""}),o(c,{prop:"title",label:"标题"},{default:l(a=>[a.row.status===0?(g(),T("a",{key:0,class:"block",href:a.row.type=="0"?"".concat(f.value,"/article-").concat(a.row.id,".html"):"".concat(f.value).concat(a.row.path,"/page-").concat(a.row.id,".html"),target:"_blank"},B(a.row.title),9,Pe)):Ve("",!0)]),_:1}),o(c,{prop:"name",label:"栏目",width:"80"}),o(c,{prop:"createdAt",label:"更新时间",width:"170"}),o(c,{prop:"status",label:"状态",width:"60"},{default:l(a=>[p(B(a.row.status==0?"显示":"隐藏"),1)]),_:1}),o(c,{fixed:"right",label:"操作",width:"150"},{default:l(a=>[o(i,{icon:m(fe),circle:"",onClick:V=>M(a.row)},null,8,["icon","onClick"]),o(i,{icon:m(_e),circle:"",onClick:V=>j(a.row)},null,8,["icon","onClick"]),o(i,{icon:m(ve),circle:"",onClick:V=>U(a.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[X,v.value]]),o(Q,{type:"flex",class:"mt-20",justify:"space-between"},{default:l(()=>[o(J,{background:"",layout:"prev, pager, next",onCurrentChange:N,"page-size":20,total:x.value,currentPage:s.value,"onUpdate:currentPage":t[3]||(t[3]=a=>s.value=a),"hide-on-single-page":""},null,8,["total","currentPage"])]),_:1})])])}}},gt=ge(qe,[["__scopeId","data-v-7648158d"]]);export{gt as default};
