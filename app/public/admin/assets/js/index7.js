import{f as R,w as j,I,O as L,P as M,Q as O,E as g}from"./element-plus.js";import{a as P,u as V}from"./vue-router.js";import{H as $,E as z}from"./@element-plus.js";import{l as H,a as K}from"./field.js";import{h as Q}from"./model.js";import{r,n as U,ab as A,c as F,o as y,O as t,T as G,L as n,a3 as J,K as W,u as h}from"./@vue.js";import"./dayjs.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./index.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vanilla-jsoneditor.js";import"./json-source-map.js";import"./@jsonquerylang.js";import"./@fortawesome.js";import"./natural-compare-lite.js";import"./fast-deep-equal.js";import"./fast-uri.js";import"./jmespath.js";import"./jsonpath-plus.js";import"./@codemirror.js";import"./@lezer.js";import"./crelt.js";import"./@marijn.js";import"./style-mod.js";import"./w3c-keyname.js";import"./@replit.js";import"./immutable-json-patch.js";import"./jsonrepair.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const X={class:"bg-fff radius-6 pd-20"},Oe={__name:"index",setup(Y){const w=P(),C=V(),i=r({mid:w.query.mid}),s=r(""),c=r(""),k=r([]),p=r([]),u=r(0),d=r(1),_=r(!0),m=async()=>{try{const e=await H(i.value.mid,d.value);if(e.code===200){const o=e.data;p.value=[...o.list],s.value=o.model.model,c.value=o.model.tableName,u.value=o.count,_.value=!1}}catch(e){console.error(e)}},E=e=>{k.value=e},x=e=>{d.value=Number(e),sessionStorage.setItem("cur",Number(e)),m()},N=e=>{const{id:o,ename:a}=e;C.push({name:"field-edit",query:{fid:o,mid:i.value.mid,table:a,model:s.value}})},B=async e=>{let{id:o}=e;try{(await Q(i.value.mid)).data.count===0?(await K(o)).code===200&&(g({message:"删除成功 ^_^",type:"success"}),m()):g({message:"当前模型正在使用，字段不能删除 ^_^",type:"warning"})}catch(a){console.error(a)}};return U(()=>{m()}),(e,o)=>{const a=R,f=A("router-link"),v=j,l=L,T=M,q=O,D=I;return y(),F("div",X,[t(v,{type:"flex",justify:"end"},{default:n(()=>[t(f,{to:{name:"field-add",query:{mid:i.value.mid,table:c.value,model:s.value}}},{default:n(()=>[t(a,{type:"primary",round:""},{default:n(()=>o[0]||(o[0]=[J("新增")])),_:1})]),_:1},8,["to"])]),_:1}),G((y(),W(T,{ref:"multipleTable",data:p.value,"tooltip-effect":"dark",style:{width:"100%"},"row-key":"id",onSelectionChange:E},{default:n(()=>[t(l,{type:"selection",width:"55"}),t(l,{prop:"id",label:"编号"}),t(l,{prop:"cname",label:"中文名称"}),t(l,{prop:"ename",label:"字段名称"}),t(l,{prop:"orderBy",label:"排序"}),t(l,{fixed:"right",label:"操作",width:"150"},{default:n(b=>[t(a,{icon:h($),circle:"",onClick:S=>N(b.row)},null,8,["icon","onClick"]),t(a,{icon:h(z),circle:"",onClick:S=>B(b.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[D,_.value]]),t(v,{type:"flex",class:"mt-20",justify:"space-between"},{default:n(()=>[t(q,{background:"",layout:"prev, pager, next",onCurrentChange:x,"page-size":10,total:u.value,"hide-on-single-page":""},null,8,["total"])]),_:1})])}}};export{Oe as default};
